#!/usr/bin/env python
# -*- coding: utf-8 -*-

import unittest
import os
import tempfile
import numpy as np
import vaspy.procar as procar


class TestPROCAR(unittest.TestCase):

    def setUp(self):
        # single state
        global procar_single
        filePROCAR = tempfile.mkstemp()
        f = open(filePROCAR[1], 'w')
        f.write(procar_single)
        f.close()
        self.procar_single = procar.PROCAR(filePROCAR[1], phase_read=True)
        os.remove(filePROCAR[1])
        # without Spi/Spin
        global procar_woSpi
        filePROCAR = tempfile.mkstemp()
        f = open(filePROCAR[1], 'w')
        f.write(procar_woSpi)
        f.close()
        self.procar_std = procar.PROCAR(filePROCAR[1], phase_read=True)
        os.remove(filePROCAR[1])
        # with Spin
        global procar_Spin
        filePROCAR = tempfile.mkstemp()
        f = open(filePROCAR[1], 'w')
        f.write(procar_Spin)
        f.close()
        self.procar_spin = procar.PROCAR(filePROCAR[1], phase_read=True)
        os.remove(filePROCAR[1])
        # with SOI (noncollinear)
        global procar_SOI
        filePROCAR = tempfile.mkstemp()
        f = open(filePROCAR[1], 'w')
        f.write(procar_SOI)
        f.close()
        self.procar_soi = procar.PROCAR(filePROCAR[1], phase_read=True)
        os.remove(filePROCAR[1])
        #
        # Band object
        #
        self.nullband = procar.BandStructure()

    def test_procar_load(self):
        pass

    def test_procar_std_print(self):
        self.assertEqual(output_print_procar_std, self.procar_std.__str__())

    def test_procar_spin_print(self):
        self.assertEqual(output_print_procar_spin, self.procar_spin.__str__())

    def test_band_check_orb_name(self):
        self.assertEqual('sp', self.nullband.check_orb_name('sp'))
        self.assertEqual('pxpy', self.nullband.check_orb_name('pypx'))
        self.assertRaises(ValueError, self.nullband.check_orb_name, 'nonexist')

    def test_BScreation_fromnull(self):
        self.nullband.kvectors = self.procar_std.kvectors
        np.testing.assert_array_equal([np.array([0.0, 0.0, 0.0]),
                                       np.array([0.25, 0.25, 0.]),
                                       np.array([0.5, 0.5, 0.])],
                                      self.nullband.kvectors)
        self.assertEqual([0.0,
                          np.sqrt(0.25 ** 2 + 0.25 ** 2),
                          np.sqrt(0.5 ** 2 + 0.5 ** 2)],
                         self.nullband.kdistance)
        self.assertEqual(3, self.nullband.numk)

    def test_BScreation_from_procar_std(self):
        testBand = self.procar_std.band()
        self.assertEqual(3, testBand.nAtoms)
        self.assertEqual(2, testBand.nBands)
        self.assertEqual(("",), testBand.spininfo)
        np.testing.assert_array_equal([np.array([0.0, 0.0, 0.0]),
                                       np.array([0.25, 0.25, 0.]),
                                       np.array([0.5, 0.5, 0.])],
                                      testBand.kvectors)
        self.assertEqual((0,), testBand.get_orb_index('s',))
        self.assertEqual((3, 1), testBand.get_orb_index('pxpy'))
        self.assertEqual((3, 2), testBand.get_orb_index('pzpx'))
        self.assertEqual((9,), testBand.get_orb_index('spd'))
        self.assertEqual((0, 3, 1, 2),
                         testBand.get_orb_index('sp'))

    def test_BScreation_from_procar_single(self):
        testBand = self.procar_single.band()
        self.assertEqual(3, testBand.nAtoms)
        self.assertEqual(1, testBand.nBands)
        np.testing.assert_array_equal([np.array([0.0, 0.0, 0.0])],
                                      testBand.kvectors)
        np.testing.assert_array_equal(
            np.array([[[[0.0000, 0.0001, 0.0002, 0.0003, 0.0004,
                         0.0005, 0.0006, 0.0007, 0.0008, 0.0036],
                        [0.0010, 0.0011, 0.0012, 0.0013, 0.0014,
                         0.0015, 0.0016, 0.0017, 0.0018, 0.0126],
                        [0.0020, 0.0021, 0.0022, 0.0023, 0.0024,
                         0.0025, 0.0026, 0.0027, 0.0028, 0.0216]]]]),
            testBand.orbitals)
        np.testing.assert_array_equal(
            np.array([[[[0.0000 + 0.0010J, 0.0001 + 0.0011J,
                         0.0002 + 0.0012J, 0.0003 + 0.0013J,
                         0.0004 + 0.0014J, 0.0005 + 0.0015J,
                         0.0006 + 0.0016J, 0.0007 + 0.0017J,
                         0.0008 + 0.0018J],
                        [0.0020 + 0.0030J, 0.0021 + 0.0031J,
                         0.0022 + 0.0032J, 0.0023 + 0.0033J,
                         0.0024 + 0.0034J, 0.0025 + 0.0035J,
                         0.0026 + 0.0036J, 0.0027 + 0.0037J,
                         0.0028 + 0.0038J],
                        [0.0040 + 0.0050J, 0.0041 + 0.0051J,
                         0.0042 + 0.0052J, 0.0043 + 0.0053J,
                         0.0044 + 0.0054J, 0.0045 + 0.0055J,
                         0.0046 + 0.0056J, 0.0047 + 0.0057J,
                         0.0048 + 0.0058J]]]]),
            testBand.phases)

    def test_BScreation_from_procar_spin(self):
        testBand = self.procar_spin.band()
        self.assertEqual(3, testBand.nAtoms)
        self.assertEqual(2, testBand.nBands)
        self.assertEqual(("_up", "_down"), testBand.spininfo)
        np.testing.assert_array_equal([np.array([0.0, 0.0, 0.0]),
                                       np.array([0.25, 0.25, 0.]),
                                       np.array([0.5, 0.5, 0.])],
                                      testBand.kvectors)
        self.assertEqual((3, 2, 3, 9), testBand.phases[0].shape)
        self.assertEqual((3, 2, 3, 9), testBand.phases[1].shape)
        self.assertEqual((3, 2, 3, 10), testBand.orbitals[0].shape)
        self.assertEqual((3, 2, 3, 10), testBand.orbitals[1].shape)

    def test_BScreation_from_procar_soi(self):
        testBand = self.procar_soi.band()
        self.assertEqual(3, testBand.nAtoms)
        self.assertEqual(2, testBand.nBands)
        self.assertEqual(("_mT", "_mX", "_mY", "_mZ"), testBand.spininfo)
        np.testing.assert_array_equal([np.array([0.0, 0.0, 0.0]),
                                       np.array([0.25, 0.25, 0.]),
                                       np.array([0.5, 0.5, 0.])],
                                      testBand.kvectors)

    def test_siteCompose_band_from_procar_std(self):
        testBand = self.procar_std.band()
        testBand.compose_sites((0, 2))
        self.assertEqual((3, 2, 1, 10), testBand.sitecomposed[0].shape)
        np.testing.assert_array_almost_equal(
            np.array([[0.0020, 0.0022, 0.0024, 0.0026, 0.0028,
                       0.0030, 0.0032, 0.0034, 0.0036, 0.0252]]),
            testBand.sitecomposed[0][0, 0])
        np.testing.assert_array_almost_equal(
            np.array([[0.020, 0.0202,  0.0204, 0.0206, 0.0208,
                       0.021, 0.0212, 0.0214, 0.0216, 0.1872]]),
            testBand.sitecomposed[0][1, 1])

    def test_composeOrbital_from_procar_std(self):
        testband = self.procar_std.band()
        testband.compose_sites((0, 1))
        testband.compose_sites((1, 2))
        testband.compose_orbital(('s', 'pxpy', 'd'))
        self.assertEqual((3, 2, 2, 12), testband.sitecomposed[0].shape)
        np.testing.assert_array_almost_equal(np.array([0.021, 0.0212, 0.0214,
                                                       0.0216, 0.0218, 0.022,
                                                       0.0222, 0.0224, 0.0226,
                                                       0.1962, 0.0428, 0.111]),
                                             testband.sitecomposed[0][1, 1, 1])
        testheader = testband.set_header(('Ag', '1st'),
                                         (('s', 'pxpy', 'tot'), ('d', 'pxpy')))
        self.assertEqual(testheader, ['#k', 'energy',
                                      'Ag_s', 'Ag_pxpy', 'Ag_tot',
                                      '1st_d', '1st_pxpy'])
        testlist = testband.list_sitecomposed_data((('s', 'pxpy', 'tot'),
                                                    ('d', 'pxpy')))
        self.assertEqual(len(testlist[0]), 7)

    def test_composeOrbital_from_procar_spin(self):
        testband = self.procar_spin.band()
        testband.compose_sites((0, 1))
        testband.compose_sites((1, 2))
        testband.compose_orbital(('s', 'pxpy', 'd'))
        self.assertEqual((3, 2, 2, 12), testband.sitecomposed[0].shape)
        self.assertEqual((3, 2, 2, 12), testband.sitecomposed[1].shape)
        np.testing.assert_array_almost_equal(np.array([0.021, 0.0212, 0.0214,
                                                       0.0216, 0.0218, 0.022,
                                                       0.0222, 0.0224, 0.0226,
                                                       0.1962, 0.0428, 0.111]),
                                             testband.sitecomposed[0][1, 1, 1])
        testheader = testband.set_header(('Ag', '1st'),
                                         (('s', 'pxpy', 'tot'), ('d', 'pxpy')))
        self.assertEqual(testheader, ['#k', 'energy_up',
                                      'Ag_s_up', 'Ag_pxpy_up', 'Ag_tot_up',
                                      '1st_d_up', '1st_pxpy_up',
                                      'energy_down',
                                      'Ag_s_down', 'Ag_pxpy_down',
                                      'Ag_tot_down',
                                      '1st_d_down', '1st_pxpy_down'])
        testlist = testband.list_sitecomposed_data((('s', 'pxpy', 'tot'),
                                                    ('d', 'pxpy')))
        self.assertEqual(len(testlist[0]), 13)

    def test_composeOrbital_from_procar_soi(self):
        testband = self.procar_soi.band()
        testband.compose_sites((0, 1))
        testband.compose_sites((1, 2))
        testband.compose_orbital(('s', 'pxpy', 'd'))
        self.assertEqual((3, 2, 2, 12), testband.sitecomposed[0].shape)
        self.assertEqual((3, 2, 2, 12), testband.sitecomposed[1].shape)
        self.assertEqual((3, 2, 2, 12), testband.sitecomposed[2].shape)
        self.assertEqual((3, 2, 2, 12), testband.sitecomposed[3].shape)
        np.testing.assert_array_almost_equal(np.array([0.021, 0.0212, 0.0214,
                                                       0.0216, 0.0218, 0.022,
                                                       0.0222, 0.0224, 0.0226,
                                                       0.1962, 0.0428, 0.111]),
                                             testband.sitecomposed[0][1, 1, 1])
        testheader = testband.set_header(('Ag', '1st'),
                                         (('s', 'pxpy', 'tot'), ('d', 'pxpy')))
        self.assertEqual(testheader, ['#k', 'energy',
                                      'Ag_s_mT', 'Ag_pxpy_mT', 'Ag_tot_mT',
                                      '1st_d_mT', '1st_pxpy_mT',
                                      'Ag_s_mX', 'Ag_pxpy_mX', 'Ag_tot_mX',
                                      '1st_d_mX', '1st_pxpy_mX',
                                      'Ag_s_mY', 'Ag_pxpy_mY', 'Ag_tot_mY',
                                      '1st_d_mY', '1st_pxpy_mY',
                                      'Ag_s_mZ', 'Ag_pxpy_mZ', 'Ag_tot_mZ',
                                      '1st_d_mZ', '1st_pxpy_mZ'])
        testlist = testband.list_sitecomposed_data((('s', 'pxpy', 'tot'),
                                                    ('d', 'pxpy')))
        self.assertEqual(len(testlist[0]), 22)

# -------------------------------------------------

output_print_procar_std = """The properties of this procar:
  # of k-points: 3
  # of bands: 2
  # of ions: 3
  # of kvectors: 3
  # of energies: 6
    ((# of k-points) * (# of bands) = 3*2=6)
  # of orbital component: 18
    ((# of k-points) * (# of bands) * (# of ions) =
        3*2*3=18)
  # of phase component: 36
  Orbitals are: ('s', 'py', 'pz', 'px', 'dxy', 'dyz', 'dz2', 'dxz', 'dx2', 'tot')
  spininfo: ('',)
"""

output_print_procar_spin = """The properties of this procar:
  # of k-points: 3
  # of bands: 2
  # of ions: 3
  # of kvectors: 6
  # of energies: 12
    ((# of k-points) * (# of bands) = 3*2=6)
  # of orbital component: 36
    ((# of k-points) * (# of bands) * (# of ions) =
        3*2*3=18)
  # of phase component: 72
  Orbitals are: ('s', 'py', 'pz', 'px', 'dxy', 'dyz', 'dz2', 'dxz', 'dx2', 'tot')
  spininfo: ('_up', '_down')
"""


procar_single = '''PROCAR lm decomposed + phase
# of k-points:     1        # of bands: 1         # of ions: 3

 k-point    1 :    0.00000000 0.00000000 0.00000000     weight = 0.33333333

band   1 # energy  -15.0000000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0000  0.0001  0.0002  0.0003  0.0004  0.0005  0.0006  0.0007  0.0008  0.0036
  2  0.0010  0.0011  0.0012  0.0013  0.0014  0.0015  0.0016  0.0017  0.0018  0.0126
  3  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
tot  0.0030  0.0033  0.0036  0.0039  0.0042  0.0045  0.0048  0.0051  0.0054  0.0368 
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0001  0.0002  0.0003  0.0004  0.0005  0.0006  0.0007  0.0008
  1  0.0010  0.0011  0.0012  0.0013  0.0014  0.0015  0.0016  0.0017  0.0018
  2  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028
  2  0.0030  0.0031  0.0032  0.0033  0.0034  0.0035  0.0036  0.0037  0.0038
  3  0.0040  0.0041  0.0042  0.0043  0.0044  0.0045  0.0046  0.0047  0.0048
  3  0.0050  0.0051  0.0052  0.0053  0.0054  0.0055  0.0056  0.0057  0.0058'''

procar_woSpi = """PROCAR lm decomposed + phase
# of k-points:    3         # of bands: 2         # of ions: 3

 k-point    1 :    0.00000000 0.00000000 0.00000000     weight = 0.33333333

band   1 # energy  -10.000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0000  0.0001  0.0002  0.0003  0.0004  0.0005  0.0006  0.0007  0.0008  0.0036
  2  0.0010  0.0011  0.0012  0.0013  0.0014  0.0015  0.0016  0.0017  0.0018  0.0126
  3  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000

band   2 # energy  -5.000000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0030  0.0031  0.0032  0.0033  0.0034  0.0035  0.0036  0.0037  0.0038  0.0306
  2  0.0040  0.0041  0.0042  0.0043  0.0044  0.0045  0.0046  0.0047  0.0048  0.0396
  3  0.0050  0.0051  0.0052  0.0053  0.0054  0.0055  0.0056  0.0057  0.0058  0.0486
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000

 k-point    2 :    0.2500000 0.2500000 0.00000000     weight = 0.33333333

band   1 # energy  -7.00000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0060  0.0061  0.0062  0.0063  0.0064  0.0065  0.0066  0.0067  0.0068  0.0576
  2  0.0070  0.0071  0.0072  0.0073  0.0074  0.0075  0.0076  0.0077  0.0078  0.0666
  3  0.0080  0.0081  0.0082  0.0083  0.0084  0.0085  0.0086  0.0087  0.0088  0.0756
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000

band   2 # energy  -4.000000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0090  0.0091  0.0092  0.0093  0.0094  0.0095  0.0096  0.0097  0.0098  0.0846
  2  0.0100  0.0101  0.0102  0.0103  0.0104  0.0105  0.0106  0.0107  0.0108  0.0936
  3  0.0110  0.0111  0.0112  0.0113  0.0114  0.0115  0.0116  0.0117  0.0118  0.1026
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000

 k-point    3 :    0.50000000 0.50000000 0.00000000     weight = 0.33333333

band   1 # energy  -6.0000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0120  0.0121  0.0122  0.0123  0.0124  0.0125  0.0126  0.0127  0.0128  0.1116
  2  0.0130  0.0131  0.0132  0.0133  0.0134  0.0135  0.0136  0.0137  0.0138  0.1206
  3  0.0140  0.0141  0.0142  0.0143  0.0144  0.0145  0.0146  0.0147  0.0148  0.1296
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000

band   2 # energy  -1.00000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0150  0.0151  0.0152  0.0153  0.0154  0.0155  0.0156  0.0157  0.0158  0.1386
  2  0.0160  0.0161  0.0162  0.0163  0.0164  0.0165  0.0166  0.0167  0.0168  0.1476
  3  0.0170  0.0171  0.0172  0.0173  0.0174  0.0175  0.0176  0.0177  0.0178  0.1566
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
"""

procar_Spin = """PROCAR lm decomposed + phase
# of k-points:    3         # of bands: 2         # of ions: 3

 k-point    1 :    0.00000000 0.00000000 0.00000000     weight = 0.33333333

band   1 # energy  -10.000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0000  0.0001  0.0002  0.0003  0.0004  0.0005  0.0006  0.0007  0.0008  0.0036 
  2  0.0010  0.0011  0.0012  0.0013  0.0014  0.0015  0.0016  0.0017  0.0018  0.0126 
  3  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000

band   2 # energy  -5.000000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0030  0.0031  0.0032  0.0033  0.0034  0.0035  0.0036  0.0037  0.0038  0.0306
  2  0.0040  0.0041  0.0042  0.0043  0.0044  0.0045  0.0046  0.0047  0.0048  0.0396
  3  0.0050  0.0051  0.0052  0.0053  0.0054  0.0055  0.0056  0.0057  0.0058  0.0486
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000

 k-point    2 :    0.2500000 0.2500000 0.00000000     weight = 0.33333333

band   1 # energy  -7.00000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0060  0.0061  0.0062  0.0063  0.0064  0.0065  0.0066  0.0067  0.0068  0.0576 
  2  0.0070  0.0071  0.0072  0.0073  0.0074  0.0075  0.0076  0.0077  0.0078  0.0666 
  3  0.0080  0.0081  0.0082  0.0083  0.0084  0.0085  0.0086  0.0087  0.0088  0.0756
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000

band   2 # energy  -4.000000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0090  0.0091  0.0092  0.0093  0.0094  0.0095  0.0096  0.0097  0.0098  0.0846 
  2  0.0100  0.0101  0.0102  0.0103  0.0104  0.0105  0.0106  0.0107  0.0108  0.0936 
  3  0.0110  0.0111  0.0112  0.0113  0.0114  0.0115  0.0116  0.0117  0.0118  0.1026 
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000

 k-point    3 :    0.50000000 0.50000000 0.00000000     weight = 0.33333333

band   1 # energy  -6.0000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0120  0.0121  0.0122  0.0123  0.0124  0.0125  0.0126  0.0127  0.0128  0.1116 
  2  0.0130  0.0131  0.0132  0.0133  0.0134  0.0135  0.0136  0.0137  0.0138  0.1206 
  3  0.0140  0.0141  0.0142  0.0143  0.0144  0.0145  0.0146  0.0147  0.0148  0.1296 
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000

band   2 # energy  -1.00000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0150  0.0151  0.0152  0.0153  0.0154  0.0155  0.0156  0.0157  0.0158  0.1386 
  2  0.0160  0.0161  0.0162  0.0163  0.0164  0.0165  0.0166  0.0167  0.0168  0.1476 
  3  0.0170  0.0171  0.0172  0.0173  0.0174  0.0175  0.0176  0.0177  0.0178  0.1566 
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000

# of k-points:    3         # of bands: 2         # of ions: 3

 k-point    1 :    0.00000000 0.00000000 0.00000000     weight = 0.33333333

band   1 # energy  -10.5000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  1.0000  1.0001  1.0002  1.0003  1.0004  1.0005  1.0006  1.0007  1.0008  9.0036 
  2  1.0010  1.0011  1.0012  1.0013  1.0014  1.0015  1.0016  1.0017  1.0018  9.0126 
  3  1.0020  1.0021  1.0022  1.0023  1.0024  1.0025  1.0026  1.0027  1.0028  9.0216 
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  1  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  2  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  2  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  3  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  3  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000

band   2 # energy  -5.500000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  1.0030  1.0031  1.0032  1.0033  1.0034  1.0035  1.0036  1.0037  1.0038  9.0306 
  2  1.0040  1.0041  1.0042  1.0043  1.0044  1.0045  1.0046  1.0047  1.0048  9.0396 
  3  1.0050  1.0051  1.0052  1.0053  1.0054  1.0055  1.0056  1.0057  1.0058  9.0486 
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  1  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  2  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  2  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  3  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  3  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000

 k-point    2 :    1.2500000 1.2500000 1.00000000     weight = 1.33333333

band   1 # energy  -7.500000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  1.0060  1.0061  1.0062  1.0063  1.0064  1.0065  1.0066  1.0067  1.0068  9.0576 
  2  1.0070  1.0071  1.0072  1.0073  1.0074  1.0075  1.0076  1.0077  1.0078  9.0666 
  3  1.0080  1.0081  1.0082  1.0083  1.0084  1.0085  1.0086  1.0087  1.0088  9.0756 
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  1  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  2  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  2  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  3  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  3  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000

band   2 # energy  -4.5000000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  1.0090  1.0091  1.0092  1.0093  1.0094  1.0095  1.0096  1.0097  1.0098  9.0846 
  2  1.0100  1.0101  1.0102  1.0103  1.0104  1.0105  1.0106  1.0107  1.0108  9.0936 
  3  1.0110  1.0111  1.0112  1.0113  1.0114  1.0115  1.0116  1.0117  1.0118  9.1026 
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2  
  1  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000   
  1  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000   
  2  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000   
  2  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000   
  3  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000   
  3  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000   

 k-point    3 :    1.50000000 1.50000000 1.00000000     weight = 1.33333333

band   1 # energy  -6.50000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  1.0120  1.0121  1.0122  1.0123  1.0124  1.0125  1.0126  1.0127  1.0128  9.1116 
  2  1.0130  1.0131  1.0132  1.0133  1.0134  1.0135  1.0136  1.0137  1.0138  9.1206 
  3  1.0140  1.0141  1.0142  1.0143  1.0144  1.0145  1.0146  1.0147  1.0148  9.1296 
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  1  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  2  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  2  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  3  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  3  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000

band   2 # energy  -1.500000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  1.0150  1.0151  1.0152  1.0153  1.0154  1.0155  1.0156  1.0157  1.0158  9.1386
  2  1.0160  1.0161  1.0162  1.0163  1.0164  1.0165  1.0166  1.0167  1.0168  9.1476
  3  1.0170  1.0171  1.0172  1.0173  1.0174  1.0175  1.0176  1.0177  1.0178  9.1566
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  1  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000   
  2  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  2  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  3  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
  3  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000
"""

procar_SOI = '''PROCAR lm decomposed + phase
# of k-points:    3         # of bands: 2         # of ions: 3

 k-point    1 :    0.00000000 0.00000000 0.00000000     weight = 0.33333333

band   1 # energy  -10.000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0000  0.0001  0.0002  0.0003  0.0004  0.0005  0.0006  0.0007  0.0008  0.0036
  2  0.0010  0.0011  0.0012  0.0013  0.0014  0.0015  0.0016  0.0017  0.0018  0.0126
  3  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  1.0000  1.0001  1.0002  1.0003  1.0004  1.0005  1.0006  1.0007  1.0008  1.0036
  2  1.0010  1.0011  1.0012  1.0013  1.0014  1.0015  1.0016  1.0017  1.0018  1.0126
  3  1.0020  1.0021  1.0022  1.0023  1.0024  1.0025  1.0026  1.0027  1.0028  1.0216
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  2.0000  2.0001  2.0002  2.0003  2.0004  2.0005  2.0006  2.0007  2.0008  2.0036
  2  2.0010  2.0011  2.0012  2.0013  2.0014  2.0015  2.0016  2.0017  2.0018  2.0126
  3  2.0020  2.0021  2.0022  2.0023  2.0024  2.0025  2.0026  2.0027  2.0028  2.0216
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  3.0000  3.0001  3.0002  3.0003  3.0004  3.0005  3.0006  3.0007  3.0008  3.0036
  2  3.0010  3.0011  3.0012  3.0013  3.0014  3.0015  3.0016  3.0017  3.0018  3.0126
  3  3.0020  3.0021  3.0022  3.0023  3.0024  3.0025  3.0026  3.0027  3.0028  3.0216
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000

band   2 # energy  -5.000000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0030  0.0031  0.0032  0.0033  0.0034  0.0035  0.0036  0.0037  0.0038  0.0306
  2  0.0040  0.0041  0.0042  0.0043  0.0044  0.0045  0.0046  0.0047  0.0048  0.0396
  3  0.0050  0.0051  0.0052  0.0053  0.0054  0.0055  0.0056  0.0057  0.0058  0.0486
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  1.0030  1.0031  1.0032  1.0033  1.0034  1.0035  1.0036  1.0037  1.0038  1.0306
  2  1.0040  1.0041  1.0042  1.0043  1.0044  1.0045  1.0046  1.0047  1.0048  1.0396
  3  1.0050  1.0051  1.0052  1.0053  1.0054  1.0055  1.0056  1.0057  1.0058  1.0486
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  2.0030  2.0031  2.0032  2.0033  2.0034  2.0035  2.0036  2.0037  2.0038  2.0306
  2  2.0040  2.0041  2.0042  2.0043  2.0044  2.0045  2.0046  2.0047  2.0048  2.0396
  3  2.0050  2.0051  2.0052  2.0053  2.0054  2.0055  2.0056  2.0057  2.0058  2.0486
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  3.0030  3.0031  3.0032  3.0033  3.0034  3.0035  3.0036  3.0037  3.0038  3.0306
  2  3.0040  3.0041  3.0042  3.0043  3.0044  3.0045  3.0046  3.0047  3.0048  3.0396
  3  3.0050  3.0051  3.0052  3.0053  3.0054  3.0055  3.0056  3.0057  3.0058  3.0486
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000

 k-point    2 :    0.2500000 0.2500000 0.00000000     weight = 0.33333333

band   1 # energy  -7.00000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0060  0.0061  0.0062  0.0063  0.0064  0.0065  0.0066  0.0067  0.0068  0.0576
  2  0.0070  0.0071  0.0072  0.0073  0.0074  0.0075  0.0076  0.0077  0.0078  0.0666
  3  0.0080  0.0081  0.0082  0.0083  0.0084  0.0085  0.0086  0.0087  0.0088  0.0756
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  1.0060  1.0061  1.0062  1.0063  1.0064  1.0065  1.0066  1.0067  1.0068  1.0576
  2  1.0070  1.0071  1.0072  1.0073  1.0074  1.0075  1.0076  1.0077  1.0078  1.0666
  3  1.0080  1.0081  1.0082  1.0083  1.0084  1.0085  1.0086  1.0087  1.0088  1.0756
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  2.0060  2.0061  2.0062  2.0063  2.0064  2.0065  2.0066  2.0067  2.0068  2.0576
  2  2.0070  2.0071  2.0072  2.0073  2.0074  2.0075  2.0076  2.0077  2.0078  2.0666
  3  2.0080  2.0081  2.0082  2.0083  2.0084  2.0085  2.0086  2.0087  2.0088  2.0756
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  3.0060  3.0061  3.0062  3.0063  3.0064  3.0065  3.0066  3.0067  3.0068  3.0576
  2  3.0070  3.0071  3.0072  3.0073  3.0074  3.0075  3.0076  3.0077  3.0078  3.0666
  3  3.0080  3.0081  3.0082  3.0083  3.0084  3.0085  3.0086  3.0087  3.0088  3.0756
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000

band   2 # energy  -4.000000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0090  0.0091  0.0092  0.0093  0.0094  0.0095  0.0096  0.0097  0.0098  0.0846
  2  0.0100  0.0101  0.0102  0.0103  0.0104  0.0105  0.0106  0.0107  0.0108  0.0936
  3  0.0110  0.0111  0.0112  0.0113  0.0114  0.0115  0.0116  0.0117  0.0118  0.1026
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  1.0090  1.0091  1.0092  1.0093  1.0094  1.0095  1.0096  1.0097  1.0098  1.0846
  2  1.0100  1.0101  1.0102  1.0103  1.0104  1.0105  1.0106  1.0107  1.0108  1.0936
  3  1.0110  1.0111  1.0112  1.0113  1.0114  1.0115  1.0116  1.0117  1.0118  1.1026
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  2.0090  2.0091  2.0092  2.0093  2.0094  2.0095  2.0096  2.0097  2.0098  2.0846
  2  2.0100  2.0101  2.0102  2.0103  2.0104  2.0105  2.0106  2.0107  2.0108  2.0936
  3  2.0110  2.0111  2.0112  2.0113  2.0114  2.0115  2.0116  2.0117  2.0118  2.1026
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  3.0090  3.0091  3.0092  3.0093  3.0094  3.0095  3.0096  3.0097  3.0098  3.0846
  2  3.0100  3.0101  3.0102  3.0103  3.0104  3.0105  3.0106  3.0107  3.0108  3.0936
  3  3.0110  3.0111  3.0112  3.0113  3.0114  3.0115  3.0116  3.0117  3.0118  3.1026
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000

 k-point    3 :    0.50000000 0.50000000 0.00000000     weight = 0.33333333

band   1 # energy  -6.0000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0120  0.0121  0.0122  0.0123  0.0124  0.0125  0.0126  0.0127  0.0128  0.1116
  2  0.0130  0.0131  0.0132  0.0133  0.0134  0.0135  0.0136  0.0137  0.0138  0.1206
  3  0.0140  0.0141  0.0142  0.0143  0.0144  0.0145  0.0146  0.0147  0.0148  0.1296
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  1.0120  1.0121  1.0122  1.0123  1.0124  1.0125  1.0126  1.0127  1.0128  1.1116
  2  1.0130  1.0131  1.0132  1.0133  1.0134  1.0135  1.0136  1.0137  1.0138  1.1206
  3  1.0140  1.0141  1.0142  1.0143  1.0144  1.0145  1.0146  1.0147  1.0148  1.1296
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  2.0120  2.0121  2.0122  2.0123  2.0124  2.0125  2.0126  2.0127  2.0128  2.1116
  2  2.0130  2.0131  2.0132  2.0133  2.0134  2.0135  2.0136  2.0137  2.0138  2.1206
  3  2.0140  2.0141  2.0142  2.0143  2.0144  2.0145  2.0146  2.0147  2.0148  2.1296
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  0.0120  0.0121  0.0122  0.0123  0.0124  0.0125  0.0126  0.0127  0.0128  0.1116
  2  0.0130  0.0131  0.0132  0.0133  0.0134  0.0135  0.0136  0.0137  0.0138  0.1206
  3  0.0140  0.0141  0.0142  0.0143  0.0144  0.0145  0.0146  0.0147  0.0148  0.1296
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000

band   2 # energy  -1.00000000 # occ.  1.00000000

ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2     tot
  1  0.0150  0.0151  0.0152  0.0153  0.0154  0.0155  0.0156  0.0157  0.0158  0.1386
  2  0.0160  0.0161  0.0162  0.0163  0.0164  0.0165  0.0166  0.0167  0.0168  0.1476
  3  0.0170  0.0171  0.0172  0.0173  0.0174  0.0175  0.0176  0.0177  0.0178  0.1566
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  1.0150  1.0151  1.0152  1.0153  1.0154  1.0155  1.0156  1.0157  1.0158  1.1386
  2  1.0160  1.0161  1.0162  1.0163  1.0164  1.0165  1.0166  1.0167  1.0168  1.1476
  3  1.0170  1.0171  1.0172  1.0173  1.0174  1.0175  1.0176  1.0177  1.0178  1.1566
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  2.0150  2.0151  2.0152  2.0153  2.0154  2.0155  2.0156  2.0157  2.0158  2.1386
  2  2.0160  2.0161  2.0162  2.0163  2.0164  2.0165  2.0166  2.0167  2.0168  2.1476
  3  2.0170  2.0171  2.0172  2.0173  2.0174  2.0175  2.0176  2.0177  2.0178  2.1566
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
  1  0.0150  0.0151  0.0152  0.0153  0.0154  0.0155  0.0156  0.0157  0.0158  0.1386
  2  0.0160  0.0161  0.0162  0.0163  0.0164  0.0165  0.0166  0.0167  0.0168  0.1476
  3  0.0170  0.0171  0.0172  0.0173  0.0174  0.0175  0.0176  0.0177  0.0178  0.1566
tot  0.0020  0.0021  0.0022  0.0023  0.0024  0.0025  0.0026  0.0027  0.0028  0.0216
ion       s      py      pz      px     dxy     dyz     dz2     dxz     dx2
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  1  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  2  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
  3  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000
'''

if __name__ == '__main__':
    unittest.main()
